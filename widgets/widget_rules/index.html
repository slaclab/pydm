<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Widget Rules &mdash; PyDM 1.24.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Including Data Plugins" href="../../add_data_plugins.html" />
    <link rel="prev" title="Display Format Utilities" href="../utilities.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            PyDM
          </a>
              <div class="version">
                1.24.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User &amp; API Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../stylesheets.html">Customizing the Look and Feel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help_files.html">Adding Help Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Widgets</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Widget Rules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-rules">Creating Rules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#opening-the-editor">Opening the Editor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-new-rule">Adding New Rule</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../add_data_plugins.html">Including Data Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application.html">Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../channel.html">Channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utilities/index.html">Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../data_plugins/local_plugin.html">Local Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_plugins/calc_plugin.html">Calc Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_plugins/p4p_plugin.html">P4P Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_plugins/external_plugins.html">External Data Plugins</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developers Corner</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/development.html">Development Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/external_tools.html">External Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="customizing.html">Customizing Properties for Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/designer_widgets.html">Designer Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/resources.html">Recommended Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/slaclab/pydm">PyDM GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/slaclab">SLAC-wide GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyDM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Widget Rules</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/widgets/widget_rules/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="widget-rules">
<h1>Widget Rules<a class="headerlink" href="#widget-rules" title="Permalink to this heading"></a></h1>
<p>Every PyDM Widget has a property named <code class="docutils literal notranslate"><span class="pre">rules</span></code> which is a String that holds a
JSON-formatted list of dictionaries describing the rules associated with that
widget.</p>
<p>The widget rules are intended to modify a widget property based on the evaluation
of an expression that can use value of one or more channels in it.</p>
<section id="creating-rules">
<h2>Creating Rules<a class="headerlink" href="#creating-rules" title="Permalink to this heading"></a></h2>
<section id="opening-the-editor">
<h3>Opening the Editor<a class="headerlink" href="#opening-the-editor" title="Permalink to this heading"></a></h3>
<p>With the designer screen open, add a PyDM Widget to the screen and right-click
on it to show the Task Menu and select the <code class="docutils literal notranslate"><span class="pre">Edit</span> <span class="pre">Rules...</span></code> option.</p>
<p>Here is a step-by-step video on how to open the <code class="docutils literal notranslate"><span class="pre">Rules</span> <span class="pre">Editor</span></code>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/open_editor.gif"><img alt="Rules Editor" src="../../_images/open_editor.gif" style="width: 609.0px; height: 349.0px;" /></a>
</figure>
<p>Here is a screenshot of the <code class="docutils literal notranslate"><span class="pre">Rules</span> <span class="pre">Editor</span></code> screen in detail.</p>
<figure class="align-center">
<img alt="Rules Editor" src="../../_images/rules_editor.png" />
</figure>
</section>
<section id="adding-new-rule">
<h3>Adding New Rule<a class="headerlink" href="#adding-new-rule" title="Permalink to this heading"></a></h3>
<p>With the <code class="docutils literal notranslate"><span class="pre">Rules</span> <span class="pre">Editor</span></code> screen open, users are able to create new rules by
clicking on the <strong>Add Rule</strong> button on the top left side or delete a rule by
clicking on the <strong>Remove Rule</strong> sign.</p>
<ul>
<li><dl class="simple">
<dt><strong>Rule Name</strong></dt><dd><p>It is very  important to give a meaningful name to a rule in order to troubleshoot
it as well as make it clear for others what this rule does.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><strong>Property</strong></dt><dd><p>The property combo box will display all possible options to be configured at this
widget using the rules mechanism. Most of the widgets will allow users to tweak
the following properties:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>Visible</strong>:</dt><dd><p>If the result of the expression is <strong>True</strong> the widget will be visible, otherwise it will be hidden.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Enable</strong>:</dt><dd><p>If the result of the expression is <strong>True</strong> the widget will be enabled, otherwise it will be disabled.</p>
</dd>
</dl>
</li>
</ul>
<p>Once a property is selected, it is time to add at least one channel to be used
as trigger and value for the expression.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><strong>Channels</strong></dt><dd><p>To do so, click at the <strong>+ Add Channel</strong> button on top of the table and fill in
the channel address.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Trigger</span></code> option defines if the expression will be evaluated or not when
this channel’s value is changed. At least one channel must be marked as <code class="docutils literal notranslate"><span class="pre">Trigger</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Enum?</span></code> option defines if the channel’s value will be converted to its
enumeration string value (when possible). When checked and a conversion is
possible, the expression should work with a text comparison. (NOTE: Uncheck
this when using MEDM calculation expressions, which always use the default
data type from the channel, to prevent automatic conversion to a text value.)</p>
<p>With the channel(s) added, it is time to create the expression.</p>
</dd>
</dl>
</li>
<li><dl>
<dt><strong>Initial Value</strong></dt><dd><p>The value set here will be sent to the widget upon instantiation of the Rule.
The value will be casted to the type expected the property.
Users can also use macros here and the macro value will be cast as other values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Initial Value does not accept expressions. It is just a simple value to be
configured into the selected property before the channels connect and the
rule start being evaluated.</p>
</div>
</dd>
</dl>
</li>
</ul>
<ul id="expression">
<li><dl>
<dt><strong>Expression</strong></dt><dd><p>When the user selects a property, the <code class="docutils literal notranslate"><span class="pre">Expected</span> <span class="pre">Type</span></code> label is updated with
the expected data type for the given property.</p>
<p>It is the user responsibility to cast the data properly and ensure that the
proper data type or equivalent is the result of the evaluation.  (See the
<code class="docutils literal notranslate"><span class="pre">Enum?</span></code> option above.)</p>
<p>In order to get data from the <code class="docutils literal notranslate"><span class="pre">channels</span></code> configured before, one must use the
special function <code class="docutils literal notranslate"><span class="pre">ch[...]</span></code> and specify the <code class="docutils literal notranslate"><span class="pre">channel</span> <span class="pre">index</span></code> according to the
table, <strong>starting from 0</strong>. E.g. <code class="docutils literal notranslate"><span class="pre">ch[0]</span></code> will fetch the value from the first
channel, <code class="docutils literal notranslate"><span class="pre">ch[2]</span></code> will fetch the value of the third channel and not the second.</p>
<p>To make the expression mechanism more flexible, users can make usage of the
following libraries:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>Numpy</strong>: <a class="reference external" href="http://www.numpy.org/">http://www.numpy.org/</a></dt><dd><p>In order to use the Numpy library functions you will need to use the <strong>np.</strong>
prefix. E.g:
For Numpy Absolute (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.absolute.html">https://docs.scipy.org/doc/numpy/reference/generated/numpy.absolute.html</a>)
you should use: <code class="docutils literal notranslate"><span class="pre">np.absolute(...)</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Math</strong>: <a class="reference external" href="https://docs.python.org/3.6/library/math.html">https://docs.python.org/3.6/library/math.html</a></dt><dd><p>The math module from Python is imported in full so different than the Numpy
case, all the functions are already imported and can be used directly without
the need to explicitly use the module name.</p>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For now, PyDM only provide support for Numpy and Math, in case other libraries
or modules are required for the expression namespace please open an Issue so
we can add it.</p>
</div>
</dd>
</dl>
</li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../utilities.html" class="btn btn-neutral float-left" title="Display Format Utilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../add_data_plugins.html" class="btn btn-neutral float-right" title="Including Data Plugins" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, hhslepicka, trendahl, zlentz, yektay, nstelter.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>