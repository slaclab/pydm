<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>A Word About Python Displays &mdash; PyDM 1.27.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Adding Code into the Main Display" href="little_code.html" />
    <link rel="prev" title="Main Screen" href="designer_main.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            PyDM
          </a>
              <div class="version">
                1.27.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro.html">Tutorial Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/launcher.html">PyDM Launcher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/channels.html">Channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/data_arch.html">Data Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/macros.html">Macro Substitution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/widgets.html">Widgets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/datasource.html">Data Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/features.html">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html">About the Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_designer.html">Introduction to Qt Designer</a></li>
<li class="toctree-l2"><a class="reference internal" href="designer.html">Building Your First Display with Qt Designer</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">A Word About Python Displays</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#building-your-ui-in-designer">Building Your UI In Designer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writing-the-code-for-your-display">Writing The Code For Your Display</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#subclassing-display">Subclassing Display</a></li>
<li class="toctree-l4"><a class="reference internal" href="#handling-command-line-arguments">Handling Command Line Arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#handling-macros">Handling Macros</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-your-interface-dynamically">Building Your Interface Dynamically</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="little_code.html">Adding Code into the Main Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="python.html">Making Pure Python Displays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/help.html">Getting Help With PyDM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contrib/requests.html">Bug and Requests</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User &amp; API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../stylesheets.html">Customizing the Look and Feel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help_files.html">Adding Help Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../widgets/index.html">Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../widgets/widget_rules/index.html">Widget Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../add_data_plugins.html">Including Data Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application.html">Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../channel.html">Channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utilities/index.html">Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../data_plugins/local_plugin.html">Local Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_plugins/calc_plugin.html">Calc Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_plugins/p4p_plugin.html">P4P Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data_plugins/external_plugins.html">External Data Plugins</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developers Corner</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../development/development.html">Development Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/external_tools.html">External Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../widgets/widget_rules/customizing.html">Customizing Properties for Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/designer_widgets.html">Designer Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/resources.html">Recommended Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/slaclab/pydm">PyDM GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/slaclab">SLAC-wide GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyDM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Tutorial</a></li>
      <li class="breadcrumb-item active">A Word About Python Displays</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tutorials/action/intro_python.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="a-word-about-python-displays">
<span id="python"></span><h1>A Word About Python Displays<a class="headerlink" href="#a-word-about-python-displays" title="Permalink to this heading"></a></h1>
<p>PyDM supports making displays that are powered by Python scripts.  This is quite
powerful - you can do anything from generating a simple display at run time
(from a file or database, for example), up to building entire applications that
utilize the PyDM widget set.  In additon to this guide, you can look at some of
PyDM’s bundled examples to see how a script-based display works.  In particular,
the ‘image_processing’ example is a good place to start.</p>
<section id="building-your-ui-in-designer">
<h2>Building Your UI In Designer<a class="headerlink" href="#building-your-ui-in-designer" title="Permalink to this heading"></a></h2>
<p>When you make a Python-based display, you can still use Qt Designer to lay out
your user interface.  In addition to the PyDM widget set, you may want to consider
using some of Qt’s base widgets like Line Edit, Push Button, etc, if your display
will have some internal functionality that does not depend on a data source.</p>
<p>For example, the ‘positioner’ example uses normal (non-PyDM) Line Edits to take
user input, performs some math on the input, and outputs the result to PVs, which
are displayed with PyDMLabels.  If you want to dynamically generate your display
when it launches, you should still build a UI file, but it might only have an empty
container (like a Vertical Layout, or a Scroll Area), which you will fill with
widgets later in your code.</p>
</section>
<section id="writing-the-code-for-your-display">
<h2>Writing The Code For Your Display<a class="headerlink" href="#writing-the-code-for-your-display" title="Permalink to this heading"></a></h2>
<p>Python-based displays in PyDM are mostly just PyQt widgets with a few extra features
on top.  This guide expects that you have a basic familiarity with PyQt and Qt itself.
Good resources for these topics are available online.  The Qt documentation, especially,
is very thorough, and will come in handy as you build your display.</p>
<section id="subclassing-display">
<span id="display"></span><h3>Subclassing Display<a class="headerlink" href="#subclassing-display" title="Permalink to this heading"></a></h3>
<p>Python-based displays are just PyQt widgets, based on PyDM’s ‘Display’ class.
Your display must subclass Display, and implement a few required methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">os</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydm</span><span class="w"> </span><span class="kn">import</span> <span class="n">Display</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyDisplay</span><span class="p">(</span><span class="n">Display</span><span class="p">):</span>
  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">macros</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">macros</span><span class="o">=</span><span class="n">macros</span><span class="p">)</span>

  <span class="k">def</span><span class="w"> </span><span class="nf">ui_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;my_display.ui&#39;</span>

  <span class="k">def</span><span class="w"> </span><span class="nf">ui_filepath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui_filename</span><span class="p">())</span>
</pre></div>
</div>
<p>Lets look at this in detail:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">os</span><span class="w"> </span><span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydm</span><span class="w"> </span><span class="kn">import</span> <span class="n">Display</span>
</pre></div>
</div>
<p>First, we import the modules we need.  You will probably want to import more of
your own modules here as well.</p>
<p>Next, we define our Display subclass, and its initializer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyDisplay</span><span class="p">(</span><span class="n">Display</span><span class="p">):</span>
  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
</pre></div>
</div>
<p>It is important to remember that you must always call the superclass’ initializer
in your own, and pass it the ‘parent’ argument from your initializer.  Otherwise,
your display might get garbage collected by Python and crash.</p>
<p>Now we must implement two methods that tell PyDM where the .ui file for this display
lives:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ui_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">return</span> <span class="s1">&#39;my_display.ui&#39;</span>
</pre></div>
</div>
<p>lets PyDM know what the .ui file to load is called, and:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ui_filepath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ui_filename</span><span class="p">())</span>
</pre></div>
</div>
<p>lets PyDM know where to find that file.  The implementation of ui_filepath used
here can probably be copied and pasted into your display verbatim: it just joins
the path of the display’s .py file to the filename of the .ui file.  Unfortunately,
at the time of writing you must include this yourself, it cannot be done automatically
by PyDM.</p>
<p>PyDM will expose all the widgets from the .ui file as a variable called ‘ui’
in your display class.  To access a widget in your code, call
<cite>self.ui.widgetName</cite></p>
</section>
<section id="handling-command-line-arguments">
<h3>Handling Command Line Arguments<a class="headerlink" href="#handling-command-line-arguments" title="Permalink to this heading"></a></h3>
<p>Displays can accept command line arguments supplied at launch.  Your display’s
initializer has a named argument called ‘args’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">macros</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</pre></div>
</div>
<p>It is recommended to use python’s <cite>argparse</cite> module to parse your arguments.
For example, you could write a method like this in your display to do this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">parse_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
  <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
  <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--list&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;magnet_list&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;File containing a list of magnet names to use.&#39;</span><span class="p">)</span>
  <span class="n">parsed_args</span><span class="p">,</span> <span class="n">_unknown_args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_known_args</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">parsed_args</span>
</pre></div>
</div>
<p>Using command line arguments can be a good way to make displays that generate
themselves dynamically: you could accept a filename argument, and read the contents
of that file to add widgets to your display.</p>
</section>
<section id="handling-macros">
<h3>Handling Macros<a class="headerlink" href="#handling-macros" title="Permalink to this heading"></a></h3>
<p>You can also use PyDM’s macro system as a way to get user data into your display.
All macros passed into your display are available as a dictionary in the initializer.
In addition, macro substitution will always be performed on the .ui file for
your display.</p>
</section>
<section id="building-your-interface-dynamically">
<h3>Building Your Interface Dynamically<a class="headerlink" href="#building-your-interface-dynamically" title="Permalink to this heading"></a></h3>
<p>A common reason to build a Python-based display is to generate your UI dynamically,
from some other source of data, like a file or database.  As mentioned in
<a class="reference internal" href="#handling-command-line-arguments">Handling Command Line Arguments</a>, you can read in command line arguments to help
get data into your display.</p>
<p>Once you have a source of data, you can use PyQt to make new widgets, and add them
to your display.  For example, if you get a list of devices from somewhere, you can
make widgets for each device, and add them to a layout you defined in the .ui file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">device_name</span> <span class="ow">in</span> <span class="n">device_list</span><span class="p">:</span>
  <span class="n">device_label</span> <span class="o">=</span> <span class="n">PyDMLabel</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_channel</span><span class="o">=</span><span class="n">device_name</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">deviceListLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">device_label</span><span class="p">)</span>
</pre></div>
</div>
<p>You usually want to put code like this in your display’s initializer, so that it
happens when the display launches.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="designer_main.html" class="btn btn-neutral float-left" title="Main Screen" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="little_code.html" class="btn btn-neutral float-right" title="Adding Code into the Main Display" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, hhslepicka, trendahl, zlentz, yektay, nstelter.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>