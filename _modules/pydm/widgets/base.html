<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pydm.widgets.base &mdash; PyDM 1.28.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            PyDM
          </a>
              <div class="version">
                1.28.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration.html">Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User &amp; API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../stylesheets.html">Customizing the Look and Feel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../help_files.html">Adding Help Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../widgets/index.html">Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../widgets/widget_rules/index.html">Widget Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../add_data_plugins.html">Including Data Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../application.html">Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../channel.html">Channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../utilities/index.html">Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../data_plugins/local_plugin.html">Local Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_plugins/calc_plugin.html">Calc Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_plugins/p4p_plugin.html">P4P Plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_plugins/external_plugins.html">External Data Plugins</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developers Corner</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../development/development.html">Development Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development/external_tools.html">External Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../widgets/widget_rules/customizing.html">Customizing Properties for Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development/designer_widgets.html">Designer Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development/resources.html">Recommended Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/slaclab/pydm">PyDM GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/slaclab">SLAC-wide GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">PyDM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pydm.widgets.base</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pydm.widgets.base</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">enum</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">platform</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">weakref</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">functools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qtpy.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QMenu</span><span class="p">,</span> <span class="n">QGraphicsOpacityEffect</span><span class="p">,</span> <span class="n">QToolTip</span><span class="p">,</span> <span class="n">QWidget</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qtpy.QtGui</span><span class="w"> </span><span class="kn">import</span> <span class="n">QCursor</span><span class="p">,</span> <span class="n">QIcon</span><span class="p">,</span> <span class="n">QClipboard</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qtpy.QtCore</span><span class="w"> </span><span class="kn">import</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QEvent</span><span class="p">,</span> <span class="n">Signal</span><span class="p">,</span> <span class="n">Slot</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.channel</span><span class="w"> </span><span class="kn">import</span> <span class="n">PyDMChannel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydm</span><span class="w"> </span><span class="kn">import</span> <span class="n">data_plugins</span><span class="p">,</span> <span class="n">tools</span><span class="p">,</span> <span class="n">config</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydm.utilities</span><span class="w"> </span><span class="kn">import</span> <span class="n">is_qt_designer</span><span class="p">,</span> <span class="n">remove_protocol</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydm.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Display</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydm.utilities</span><span class="w"> </span><span class="kn">import</span> <span class="n">ACTIVE_QT_WRAPPER</span><span class="p">,</span> <span class="n">QtWrapperTypes</span>

<span class="k">if</span> <span class="n">ACTIVE_QT_WRAPPER</span> <span class="o">==</span> <span class="n">QtWrapperTypes</span><span class="o">.</span><span class="n">PYSIDE6</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">PySide6.QtCore</span><span class="w"> </span><span class="kn">import</span> <span class="n">Property</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtCore</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyqtProperty</span> <span class="k">as</span> <span class="n">Property</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.rules</span><span class="w"> </span><span class="kn">import</span> <span class="n">RulesDispatcher</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">json.decoder</span><span class="w"> </span><span class="kn">import</span> <span class="n">JSONDecodeError</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">JSONDecodeError</span> <span class="o">=</span> <span class="ne">ValueError</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">str_types</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="n">str_types</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">,)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_icon_file</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the absolute path to the icon filename provided.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The filename of the icon, relative to ``pydm.icons``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The absolute path to the icon file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
    <span class="n">icon_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_path</span><span class="p">,</span> <span class="s2">&quot;icons&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">icon_path</span>


<span class="k">def</span><span class="w"> </span><span class="nf">is_channel_valid</span><span class="p">(</span><span class="n">channel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Verify if a channel string is valid.</span>
<span class="sd">    For now a valid channel is a channel in which:</span>
<span class="sd">    - It is not None</span>
<span class="sd">    - It is not an empty string</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    channel : str</span>
<span class="sd">        The channel value</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    valid : bool</span>
<span class="sd">        Returns True if the channel is valid, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">channel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">channel</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">only_if_channel_set</span><span class="p">(</span><span class="n">fcn</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to avoid executing a method if a channel is not valid or configured.&quot;&quot;&quot;</span>

    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">fcn</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_channel_valid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">fcn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span>

    <span class="k">return</span> <span class="n">wrapper</span>


<span class="k">def</span><span class="w"> </span><span class="nf">widget_destroyed</span><span class="p">(</span><span class="n">channels</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Callback invoked when the Widget is destroyed.</span>
<span class="sd">    This method is used to ensure that the channels are disconnected.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    channels : list</span>
<span class="sd">        A list of PyDMChannel objects that this widget uses.</span>
<span class="sd">    widget : weakref</span>
<span class="sd">        Weakref to the widget.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chs</span> <span class="o">=</span> <span class="n">channels</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">chs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">chs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ch</span><span class="p">:</span>
                <span class="n">ch</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="n">destroying</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">RulesDispatcher</span><span class="p">()</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">refresh_style</span><span class="p">(</span><span class="n">widget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method that traverse the widget tree starting at `widget` and refresh the</span>
<span class="sd">    style for this widget and its children.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    widget : QWidget</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">widgets</span> <span class="o">=</span> <span class="p">[</span><span class="n">widget</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">widgets</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QWidget</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1"># If we fail it means that widget is probably destroyed</span>
        <span class="k">return</span>
    <span class="k">for</span> <span class="n">child_widget</span> <span class="ow">in</span> <span class="n">widgets</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">child_widget</span><span class="o">.</span><span class="n">style</span><span class="p">()</span><span class="o">.</span><span class="n">unpolish</span><span class="p">(</span><span class="n">child_widget</span><span class="p">)</span>
            <span class="n">child_widget</span><span class="o">.</span><span class="n">style</span><span class="p">()</span><span class="o">.</span><span class="n">polish</span><span class="p">(</span><span class="n">child_widget</span><span class="p">)</span>
            <span class="n">child_widget</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="c1"># Widget was probably destroyed</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Error while refreshing stylesheet. </span><span class="si">%s</span><span class="s2"> &quot;</span><span class="p">,</span> <span class="n">ex</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">PostParentClassInitSetup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># This function should only be called from a pydm widget class&#39;s __init__ call, and *not* from</span>
    <span class="c1"># from the __init__ of it&#39;s parent classes (PyDMWidget/PyDMPrimitiveWidget) where it throws an error on pyside6.</span>
    <span class="c1"># The error is pyside6 thinks the widget class&#39;s parent __init__ calls are not getting called</span>
    <span class="c1"># in the proper order, despite the fact that we explicitly call them so there should be no real issue.</span>
    <span class="c1"># (see commit-msg of beb3c5533b717c3c9a00bd35c8615d900abbc03c for more explanation)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setContextMenuPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">DefaultContextMenu</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_qt_designer</span><span class="p">():</span>
        <span class="c1"># Install event filter only if not running in Designer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">installEventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># Will call the widget class&#39;s check_enable_state if it has one, else will use PyDMWidget&#39;s.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_enable_state</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">destroyed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">widget_destroyed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">,</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>


<span class="k">class</span><span class="w"> </span><span class="nc">PyDMPrimitiveWidget</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Primitive class that determines that a given widget is a PyDMWidget.</span>
<span class="sd">    All Widget classes from PyDMWidget will be True for</span>
<span class="sd">    isinstance(obj, PyDMPrimitiveWidget)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DEFAULT_RULE_PROPERTY</span> <span class="o">=</span> <span class="s2">&quot;Visible&quot;</span>
    <span class="n">RULE_PROPERTIES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Enable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;setEnabled&quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">],</span>
        <span class="s2">&quot;Visible&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;setVisible&quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">],</span>
        <span class="s2">&quot;Opacity&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;set_opacity&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_opacity</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__init_subclass__</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds or redefines rule-triggered property configuration for derivative</span>
<span class="sd">        classes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_properties: dict</span>
<span class="sd">            A dictionary containing the properties that can be modified</span>
<span class="sd">            through rule triggers. The format of this dictionary must</span>
<span class="sd">            follow the one for entries in PyDMPrimitiveWidget.RULE_PROPERTIES.</span>
<span class="sd">            Namely, the key should be a name to be displayed by the Rule</span>
<span class="sd">            Editor (in designer), and the value a list containing two elements:</span>
<span class="sd">            a string naming the method in the class that will handle the</span>
<span class="sd">            rule dispatch, and a type matching the one that we expect to</span>
<span class="sd">            receive from the PV value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;new_properties&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">new_properties</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">RULE_PROPERTIES</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">RULE_PROPERTIES</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">RULE_PROPERTIES</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">new_properties</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_designer_icon</span><span class="p">():</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Icon for usage in Qt designer.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">QIcon</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">eventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        EventFilter to redirect &quot;middle click&quot; to :meth:`.show_address_tooltip`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Override the eventFilter to capture all middle mouse button events,</span>
        <span class="c1"># and show a tooltip if needed.</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">==</span> <span class="n">QEvent</span><span class="o">.</span><span class="n">MouseButtonPress</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">MiddleButton</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">show_address_tooltip</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">show_address_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show the PyDMTooltip and copy address to clipboard</span>

<span class="sd">        This is intended to replicate the behavior of the &quot;middle click&quot; from</span>
<span class="sd">        EDM. If the QWidget does not have a valid PyDMChannel nothing will be</span>
<span class="sd">        displayed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">channels_method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;channels&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">channels_method</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="n">channels_method</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">channels</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Widget has no channels to display tooltip&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">addrs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">no_proto_addrs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ch</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">addr</span> <span class="o">=</span> <span class="n">ch</span><span class="o">.</span><span class="n">address</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">addr</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">addrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
            <span class="n">no_proto_addrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">remove_protocol</span><span class="p">(</span><span class="n">addr</span><span class="p">))</span>

        <span class="n">tooltip</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">addrs</span><span class="p">)</span>
        <span class="n">clipboard_text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">no_proto_addrs</span><span class="p">)</span>
        <span class="n">QToolTip</span><span class="o">.</span><span class="n">showText</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">globalPos</span><span class="p">(),</span> <span class="n">tooltip</span><span class="p">)</span>
        <span class="c1"># If the address has a protocol, strip it out before putting it on the</span>
        <span class="c1"># clipboard.</span>

        <span class="n">clipboard</span> <span class="o">=</span> <span class="n">QApplication</span><span class="o">.</span><span class="n">clipboard</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
            <span class="c1"># Mode Selection is only valid for X11.</span>
            <span class="n">clipboard</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">clipboard_text</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">QClipboard</span><span class="o">.</span><span class="n">Selection</span><span class="p">)</span>

        <span class="n">clipboard</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">clipboard_text</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">QClipboard</span><span class="o">.</span><span class="n">Clipboard</span><span class="p">)</span>
        <span class="n">event</span> <span class="o">=</span> <span class="n">QEvent</span><span class="p">(</span><span class="n">QEvent</span><span class="o">.</span><span class="n">Clipboard</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">sendEvent</span><span class="p">(</span><span class="n">clipboard</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">opacity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Float value between 0 and 1 representing the opacity of the widget</span>
<span class="sd">        where 0 means transparent.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        opacity : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opacity</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_opacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Float value between 0 and 1 representing the opacity of the widget</span>
<span class="sd">        where 0 means transparent.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        val : float</span>
<span class="sd">            The new value for the opacity</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">QGraphicsOpacityEffect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_opacity</span> <span class="o">=</span> <span class="n">val</span>
        <span class="n">op</span><span class="o">.</span><span class="n">setOpacity</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>  <span class="c1"># 0 to 1 will cause the fade effect to kick in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setGraphicsEffect</span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAutoFillBackground</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rule_evaluated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback called when a rule has a new value for a property.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        payload : dict</span>
<span class="sd">            Dictionary containing the rule name, the property to be set and the</span>
<span class="sd">            new value.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">prop</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;property&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">prop</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">RULE_PROPERTIES</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error at Rule: </span><span class="si">%s</span><span class="s2">. </span><span class="si">%s</span><span class="s2"> is not part of this widget properties.&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">method_name</span><span class="p">,</span> <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RULE_PROPERTIES</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="nb">bool</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">str_types</span><span class="p">):</span>
                <span class="c1"># We do this as we already import json and for Python:</span>
                <span class="c1"># bool(&quot;False&quot;) -&gt; True</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">data_type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
                <span class="n">method</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Error at Rule: </span><span class="si">%s</span><span class="s2">. Could not execute method </span><span class="si">%s</span><span class="s2"> with value </span><span class="si">%s</span><span class="s2"> and type as </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="p">,</span>
                <span class="n">method_name</span><span class="p">,</span>
                <span class="n">value</span><span class="p">,</span>
                <span class="n">data_type</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">readRules</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        JSON-formatted list of dictionaries, with rules for the widget.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setRules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_rules</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        JSON-formatted list of dictionaries, with rules for the widget.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_rules : str</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">new_rules</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rules</span> <span class="o">=</span> <span class="n">new_rules</span>
            <span class="n">RulesDispatcher</span><span class="p">()</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rules_list</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rules</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rules_list</span><span class="p">:</span>
                    <span class="n">RulesDispatcher</span><span class="p">()</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rules_list</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">JSONDecodeError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Invalid format for Rules&quot;</span><span class="p">)</span>

    <span class="n">rules</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">readRules</span><span class="p">,</span> <span class="n">setRules</span><span class="p">,</span> <span class="n">designable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">find_parent_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">widget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">Display</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">widget</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>


<span class="k">class</span><span class="w"> </span><span class="nc">AlarmLimit</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An enum for holding values corresponding to the EPICS alarm limits&quot;&quot;&quot;</span>

    <span class="n">HIHI</span> <span class="o">=</span> <span class="s2">&quot;HIHI&quot;</span>
    <span class="n">HIGH</span> <span class="o">=</span> <span class="s2">&quot;HIGH&quot;</span>
    <span class="n">LOW</span> <span class="o">=</span> <span class="s2">&quot;LOW&quot;</span>
    <span class="n">LOLO</span> <span class="o">=</span> <span class="s2">&quot;LOLO&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">TextFormatter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">default_precision_from_pv</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_units</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision_from_pv</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_user_prec</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prec</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unit</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_format_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reconstruct the format string to be used when representing the</span>
<span class="sd">        output value.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        format_string : str</span>
<span class="sd">            The format string to be used including or not the precision</span>
<span class="sd">            and unit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">format_string</span> <span class="o">=</span> <span class="s2">&quot;{:.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;f}&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show_units</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unit</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">format_string</span> <span class="o">+=</span> <span class="s2">&quot; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_unit</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_string</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">precision_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_precision</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback invoked when the Channel has new precision value.</span>
<span class="sd">        This callback also triggers an update_format_string call so the</span>
<span class="sd">        new precision value is considered.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_precision : int or float</span>
<span class="sd">            The new precision value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">precisionFromPV</span> <span class="ow">and</span> <span class="n">new_precision</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prec</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prec</span> <span class="o">=</span> <span class="n">new_precision</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value_changed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">precisionChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_prec</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT Slot for changes on the precision of the Channel</span>
<span class="sd">        This slot sends the new precision value to the</span>
<span class="sd">        ```precision_changed``` callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_prec : int or float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precision_changed</span><span class="p">(</span><span class="n">new_prec</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">readPrecision</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The precision to be used when formatting the output of the PV</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        prec : int</span>
<span class="sd">            The current precision value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">precisionFromPV</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prec</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_prec</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setPrecision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_prec</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The precision to be used when formatting the output of the PV.</span>
<span class="sd">        This has no effect when ```precisionFromPV``` is True.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_prec : int</span>
<span class="sd">            The new precision value to use</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Only allow one to change the property if not getting the precision</span>
        <span class="c1"># from the PV</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_precision_from_pv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_precision_from_pv</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">new_prec</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_user_prec</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="n">new_prec</span><span class="p">)</span> <span class="ow">and</span> <span class="n">new_prec</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_user_prec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">new_prec</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_qt_designer</span><span class="p">()</span> <span class="ow">or</span> <span class="n">config</span><span class="o">.</span><span class="n">DESIGNER_ONLINE</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value_changed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="n">precision</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">readPrecision</span><span class="p">,</span> <span class="n">setPrecision</span><span class="p">)</span>

    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unitChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_unit</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT Slot for changes on the unit of the Channel</span>
<span class="sd">        This slot sends the new unit string to the</span>
<span class="sd">        ```unit_changed``` callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_unit : str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit_changed</span><span class="p">(</span><span class="n">new_unit</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">unit_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_unit</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback invoked when the Channel has new unit value.</span>
<span class="sd">        This callback also triggers an update_format_string call so the</span>
<span class="sd">        new unit value is considered if ```showUnits``` is set.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_unit : str</span>
<span class="sd">            The new unit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unit</span> <span class="o">!=</span> <span class="n">new_unit</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unit</span> <span class="o">=</span> <span class="n">new_unit</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value_changed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">readShowUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A choice whether or not to show the units given by the channel</span>

<span class="sd">        If set to True, the units given in the channel will be displayed</span>
<span class="sd">        with the value. If using an EPICS channel, this will automatically</span>
<span class="sd">        be linked to the EGU field of the PV.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        show_units : bool</span>
<span class="sd">            True means that the unit will be appended to the output value</span>
<span class="sd">            format string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show_units</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setShowUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show_units</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A choice whether or not to show the units given by the channel</span>

<span class="sd">        If set to True, the units given in the channel will be displayed</span>
<span class="sd">        with the value. If using an EPICS channel, this will automatically</span>
<span class="sd">        be linked to the EGU field of the PV.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ---------</span>
<span class="sd">        show_units : bool</span>
<span class="sd">            True means that the unit will be appended to the output value</span>
<span class="sd">            format string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show_units</span> <span class="o">!=</span> <span class="n">show_units</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_show_units</span> <span class="o">=</span> <span class="n">show_units</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_format_string</span><span class="p">()</span>

    <span class="n">showUnits</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">readShowUnits</span><span class="p">,</span> <span class="n">setShowUnits</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">readPrecisionFromPV</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A choice whether or not to use the precision given by channel.</span>

<span class="sd">        If set to False, the value received will be displayed as is, with</span>
<span class="sd">        no modification to the number of displayed significant figures.</span>
<span class="sd">        However, if set to True, and the channel specifies a display</span>
<span class="sd">        precision, a float or integer channel value will be set to display</span>
<span class="sd">        the correct precision. When using an EPICS Channel, the precision</span>
<span class="sd">        value corresponds to the PV&#39;s PREC field.</span>

<span class="sd">        It is also important to note, that if the value of the channel</span>
<span class="sd">        is a String, the choice of True or False will have no affect on</span>
<span class="sd">        the display.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        precision_from_pv : bool</span>
<span class="sd">            True means that the widget will use the precision information</span>
<span class="sd">            from the Channel if available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_precision_from_pv</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_precision_from_pv</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_precision_from_pv</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setPrecisionFromPV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A choice whether or not to use the precision given by channel.</span>

<span class="sd">        If set to False, the value received will be displayed as is, with</span>
<span class="sd">        no modification to the number of displayed significant figures.</span>
<span class="sd">        However, if set to True, and the channel specifies a display</span>
<span class="sd">        precision, a float or integer channel value will be set to</span>
<span class="sd">        display the correct precision. When using an EPICS Channel, the</span>
<span class="sd">        precision value corresponds to the PV&#39;s PREC field.</span>

<span class="sd">        It is also important to note, that if the value of the channel is</span>
<span class="sd">        a String, the choice of True or False will have no affect on the</span>
<span class="sd">        display.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bool</span>
<span class="sd">            True means that the widget will use the precision information</span>
<span class="sd">            from the PV if available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_precision_from_pv</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_precision_from_pv</span> <span class="o">!=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precision_from_pv</span> <span class="o">=</span> <span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_format_string</span><span class="p">()</span>

    <span class="n">precisionFromPV</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">readPrecisionFromPV</span><span class="p">,</span> <span class="n">setPrecisionFromPV</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">value_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback invoked when the Channel value is changed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_val : str, int, float, bool or np.ndarray</span>
<span class="sd">            The new value from the channel. The type depends on the channel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">value_changed</span><span class="p">(</span><span class="n">new_val</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_format_string</span><span class="p">()</span>


<span class="n">_positionRuleProperties</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Position - X&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;setX&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="s2">&quot;Position - Y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;setY&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">]}</span>


<div class="viewcode-block" id="PyDMWidget"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget">[docs]</a><span class="k">class</span><span class="w"> </span><span class="nc">PyDMWidget</span><span class="p">(</span><span class="n">PyDMPrimitiveWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PyDM base class for Read-Only widgets.</span>
<span class="sd">    This class implements all the functions of connection, alarm</span>
<span class="sd">    handling and more.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    init_channel : str, optional</span>
<span class="sd">        The channel to be used by the widget.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># this is same for all instances of the class, so don&#39;t define with &#39;.self&#39;</span>
    <span class="n">new_properties</span> <span class="o">=</span> <span class="n">_positionRuleProperties</span>

    <span class="c1"># Alarm types</span>
    <span class="n">ALARM_NONE</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ALARM_MINOR</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">ALARM_MAJOR</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">ALARM_INVALID</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">ALARM_DISCONNECTED</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_channel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_channels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_units</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alarm_sensitive_content</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alarm_sensitive_border</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alarm_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ALARM_NONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tooltip</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_upper_ctrl_limit</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lower_ctrl_limit</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">upper_alarm_limit</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lower_alarm_limit</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upper_warning_limit</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lower_warning_limit</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enum_strings</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channeltype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_pydm_tool_tip</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tool_tip_substrings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tool_tip_channel_table</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;_channel&quot;</span><span class="p">,</span>
            <span class="s2">&quot;connection&quot;</span><span class="p">:</span> <span class="s2">&quot;_connected&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SEVR&quot;</span><span class="p">:</span> <span class="s2">&quot;_alarm_state&quot;</span><span class="p">,</span>
            <span class="s2">&quot;enum_strings&quot;</span><span class="p">:</span> <span class="s2">&quot;enum_strings&quot;</span><span class="p">,</span>
            <span class="s2">&quot;EGU&quot;</span><span class="p">:</span> <span class="s2">&quot;_unit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PREC&quot;</span><span class="p">:</span> <span class="s2">&quot;_prec&quot;</span><span class="p">,</span>
            <span class="s2">&quot;DRVH&quot;</span><span class="p">:</span> <span class="s2">&quot;_upper_ctrl_limit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;DRVL&quot;</span><span class="p">:</span> <span class="s2">&quot;_lower_ctrl_limit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;HIHI&quot;</span><span class="p">:</span> <span class="s2">&quot;upper_alarm_limit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;LOLO&quot;</span><span class="p">:</span> <span class="s2">&quot;lower_alarm_limit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;HIGH&quot;</span><span class="p">:</span> <span class="s2">&quot;upper_warning_limit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;LOW&quot;</span><span class="p">:</span> <span class="s2">&quot;lower_warning_limit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;TIME&quot;</span><span class="p">:</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># If this label is inside a PyDMApplication (not Designer) start it in</span>
        <span class="c1"># the disconnected state.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contextMenuEvent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_context_menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="n">init_channel</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_qt_designer</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alarmSeverityChanged</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ALARM_DISCONNECTED</span><span class="p">)</span>

<div class="viewcode-block" id="PyDMWidget.widget_ctx_menu"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.widget_ctx_menu">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">widget_ctx_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fetch the Widget specific context menu which will be populated with additional tools by `assemble_tools_menu`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        QMenu or None</span>
<span class="sd">            If the return of this method is None a new QMenu will be created by `assemble_tools_menu`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PyDMWidget.generate_context_menu"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.generate_context_menu">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_context_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the custom context menu, and populates it with any external</span>
<span class="sd">        tools that have been loaded.  PyDMWidget subclasses should override</span>
<span class="sd">        this method (after calling superclass implementation) to add the menu.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        QMenu</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_ctx_menu</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">menu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">menu</span> <span class="o">=</span> <span class="n">QMenu</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels_for_tools</span><span class="p">(),</span> <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="p">}</span>
        <span class="n">tools</span><span class="o">.</span><span class="n">assemble_tools_menu</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="n">widget_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">widget</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Add a view help action if the parent display has an associated help file</span>
        <span class="n">parent_display</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_parent_display</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">parent_display</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">parent_display</span><span class="o">.</span><span class="n">help_window</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">menu</span><span class="o">.</span><span class="n">actions</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s2">&quot;View Help for this Display&quot;</span><span class="p">,</span> <span class="n">parent_display</span><span class="o">.</span><span class="n">show_help</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">menu</span></div>

<div class="viewcode-block" id="PyDMWidget.open_context_menu"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.open_context_menu">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">open_context_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ev</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler for when the Default Context Menu is requested.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ev : QEvent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_context_menu</span><span class="p">()</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">exec_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mapToGlobal</span><span class="p">(</span><span class="n">ev</span><span class="o">.</span><span class="n">pos</span><span class="p">()))</span>
        <span class="k">del</span> <span class="n">menu</span></div>

<div class="viewcode-block" id="PyDMWidget.init_for_designer"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.init_for_designer">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">init_for_designer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method called after the constructor to tweak configurations for</span>
<span class="sd">        when using the widget with the Qt Designer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="PyDMWidget.connection_changed"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.connection_changed">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">connection_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connected</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback invoked when the connection state of the Channel is changed.</span>
<span class="sd">        This callback acts on the connection state to enable/disable the widget</span>
<span class="sd">        and also trigger the change on alarm severity to ALARM_DISCONNECTED.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        connected : int</span>
<span class="sd">            When this value is 0 the channel is disconnected, 1 otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span> <span class="o">=</span> <span class="n">connected</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_enable_state</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">connected</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alarmSeverityChanged</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ALARM_DISCONNECTED</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alarmSeverityChanged</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ALARM_NONE</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.value_changed"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.value_changed">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">value_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback invoked when the Channel value is changed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_val : str, int, float, bool or np.ndarray</span>
<span class="sd">            The new value from the channel. The type depends on the channel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">new_val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channeltype</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channeltype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channeltype</span> <span class="o">==</span> <span class="n">unicode</span><span class="p">:</span>
                    <span class="c1"># For Python 2.7, set the the channel type to str instead of unicode</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">channeltype</span> <span class="o">=</span> <span class="nb">str</span>
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="k">pass</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">readAlarmSeverity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alarm_state</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setAlarmSeverity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_severity</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alarm_state</span> <span class="o">!=</span> <span class="n">new_severity</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_alarm_state</span> <span class="o">=</span> <span class="n">new_severity</span>

    <span class="n">alarmSeverity</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">readAlarmSeverity</span><span class="p">,</span> <span class="n">setAlarmSeverity</span><span class="p">,</span> <span class="n">designable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="PyDMWidget.alarm_severity_changed"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.alarm_severity_changed">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">alarm_severity_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_alarm_severity</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback invoked when the Channel alarm severity is changed.</span>
<span class="sd">        This callback is not processed if the widget has no channel</span>
<span class="sd">        associated with it.</span>
<span class="sd">        This callback handles the composition of the stylesheet to be</span>
<span class="sd">        applied and the call</span>
<span class="sd">        to update to redraw the widget with the needed changes for the</span>
<span class="sd">        new state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_alarm_severity : int</span>
<span class="sd">            The new severity where 0 = NO_ALARM, 1 = MINOR, 2 = MAJOR</span>
<span class="sd">            and 3 = INVALID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 0 = NO_ALARM, 1 = MINOR, 2 = MAJOR, 3 = INVALID</span>
        <span class="k">if</span> <span class="n">new_alarm_severity</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alarm_state</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_alarm_state</span> <span class="o">=</span> <span class="n">PyDMWidget</span><span class="o">.</span><span class="n">ALARM_NONE</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_alarm_state</span> <span class="o">=</span> <span class="n">new_alarm_severity</span>
        <span class="n">refresh_style</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.enum_strings_changed"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.enum_strings_changed">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">enum_strings_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_enum_strings</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback invoked when the Channel has new enum values.</span>
<span class="sd">        This callback also triggers a value_changed call so the</span>
<span class="sd">        new enum values to be broadcasted</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_enum_strings : tuple</span>
<span class="sd">            The new list of values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">new_enum_strings</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">enum_strings</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enum_strings</span> <span class="o">=</span> <span class="n">new_enum_strings</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value_changed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.timestamp_changed"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.timestamp_changed">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">timestamp_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_timestamp</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback invoked when the Channel has new timestamp values.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_timestamp : float</span>
<span class="sd">            The new timestamp value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">new_timestamp</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">new_timestamp</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_channels</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Object </span><span class="si">%r</span><span class="s2"> has no PyDM Channels&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">address</span>

<div class="viewcode-block" id="PyDMWidget.ctrl_limit_changed"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.ctrl_limit_changed">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">ctrl_limit_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback invoked when the Channel receives new control limit</span>
<span class="sd">        values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        which : str</span>
<span class="sd">            Which control limit was changed. &quot;UPPER&quot; or &quot;LOWER&quot;</span>
<span class="sd">        new_limit : float</span>
<span class="sd">            New value for the control limit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;UPPER&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_upper_ctrl_limit</span> <span class="o">=</span> <span class="n">new_limit</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lower_ctrl_limit</span> <span class="o">=</span> <span class="n">new_limit</span></div>

<div class="viewcode-block" id="PyDMWidget.alarm_limit_changed"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.alarm_limit_changed">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">alarm_limit_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which</span><span class="p">:</span> <span class="n">AlarmLimit</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback invoked when the channel receives new alarm limit values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        which : AlarmLimit</span>
<span class="sd">            Which alarm limit was changed. &quot;HIHI&quot;, &quot;HIGH&quot;, &quot;LOW&quot;, &quot;LOLO&quot;</span>
<span class="sd">        new_limit : float</span>
<span class="sd">            New value for the alarm limit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">which</span> <span class="ow">is</span> <span class="n">AlarmLimit</span><span class="o">.</span><span class="n">HIHI</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">upper_alarm_limit</span> <span class="o">=</span> <span class="n">new_limit</span>
        <span class="k">elif</span> <span class="n">which</span> <span class="ow">is</span> <span class="n">AlarmLimit</span><span class="o">.</span><span class="n">HIGH</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">upper_warning_limit</span> <span class="o">=</span> <span class="n">new_limit</span>
        <span class="k">elif</span> <span class="n">which</span> <span class="ow">is</span> <span class="n">AlarmLimit</span><span class="o">.</span><span class="n">LOW</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lower_warning_limit</span> <span class="o">=</span> <span class="n">new_limit</span>
        <span class="k">elif</span> <span class="n">which</span> <span class="ow">is</span> <span class="n">AlarmLimit</span><span class="o">.</span><span class="n">LOLO</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lower_alarm_limit</span> <span class="o">=</span> <span class="n">new_limit</span></div>

<div class="viewcode-block" id="PyDMWidget.connectionStateChanged"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.connectionStateChanged">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connectionStateChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connected</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT Slot for changes on the Connection State of the Channel</span>
<span class="sd">        This slot sends the connection state to the ```connection_changed```</span>
<span class="sd">        callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        connected : bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># false = disconnected, true = connected</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection_changed</span><span class="p">(</span><span class="n">connected</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.channelValueChanged"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.channelValueChanged">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="nd">@Slot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">channelValueChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT Slot for changes on the Value of the Channel</span>
<span class="sd">        This slot sends the value to the ```value_changed``` callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_val : int, float, str, bool or np.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value_changed</span><span class="p">(</span><span class="n">new_val</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.alarmSeverityChanged"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.alarmSeverityChanged">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">alarmSeverityChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_alarm_severity</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT Slot for changes on the Alarm Severity of the Channel</span>
<span class="sd">        This slot sends the severity value to the</span>
<span class="sd">        ```alarm_severity_changed``` callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_alarm_severity : int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alarm_severity_changed</span><span class="p">(</span><span class="n">new_alarm_severity</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.enumStringsChanged"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.enumStringsChanged">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">tuple</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">enumStringsChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_enum_strings</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT Slot for changes on the string values of the Channel</span>
<span class="sd">        This slot sends the new strings to the</span>
<span class="sd">        ```enum_strings_changed``` callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_enum_strings : tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enum_strings_changed</span><span class="p">(</span><span class="n">new_enum_strings</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.upperCtrlLimitChanged"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.upperCtrlLimitChanged">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">upperCtrlLimitChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT Slot for changes on the upper control limit value of the Channel</span>
<span class="sd">        This slot sends the new limit value to the</span>
<span class="sd">        ```ctrl_limit_changed``` callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_limit : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctrl_limit_changed</span><span class="p">(</span><span class="s2">&quot;UPPER&quot;</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.lowerCtrlLimitChanged"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.lowerCtrlLimitChanged">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lowerCtrlLimitChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT Slot for changes on the lower control limit value of the Channel</span>
<span class="sd">        This slot sends the new limit value to the</span>
<span class="sd">        ```ctrl_limit_changed``` callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_limit : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctrl_limit_changed</span><span class="p">(</span><span class="s2">&quot;LOWER&quot;</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.upper_alarm_limit_changed"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.upper_alarm_limit_changed">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">upper_alarm_limit_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT slot for changes to the HIHI alarm limit of a PV</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_limit : float</span>
<span class="sd">           The new value for the HIHI limit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alarm_limit_changed</span><span class="p">(</span><span class="n">AlarmLimit</span><span class="o">.</span><span class="n">HIHI</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.lower_alarm_limit_changed"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.lower_alarm_limit_changed">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lower_alarm_limit_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT slot for changes to the LOLO alarm limit of a PV</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_limit : float</span>
<span class="sd">           The new value for the LOLO limit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alarm_limit_changed</span><span class="p">(</span><span class="n">AlarmLimit</span><span class="o">.</span><span class="n">LOLO</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.upper_warning_limit_changed"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.upper_warning_limit_changed">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">upper_warning_limit_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT slot for changes to the HIGH alarm limit of a PV</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_limit : float</span>
<span class="sd">           The new value for the HIGH limit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alarm_limit_changed</span><span class="p">(</span><span class="n">AlarmLimit</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.lower_warning_limit_changed"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.lower_warning_limit_changed">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lower_warning_limit_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT slot for changes to the LOW alarm limit of a PV</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_limit : float</span>
<span class="sd">           The new value for the LOW limit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alarm_limit_changed</span><span class="p">(</span><span class="n">AlarmLimit</span><span class="o">.</span><span class="n">LOW</span><span class="p">,</span> <span class="n">new_limit</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.force_redraw"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.force_redraw">[docs]</a>    <span class="nd">@Slot</span><span class="p">()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">force_redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT Slot to force a redraw on the widget.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyDMWidget.setX"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.setX">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">setX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the X position of the Widget on the screen.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_x : int</span>
<span class="sd">            The new X position</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span>
        <span class="n">point</span><span class="o">.</span><span class="n">setX</span><span class="p">(</span><span class="n">new_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">point</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.setY"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.setY">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">setY</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the Y position of the Widget on the screen.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_y : int</span>
<span class="sd">            The new Y position</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span>
        <span class="n">point</span><span class="o">.</span><span class="n">setY</span><span class="p">(</span><span class="n">new_y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">point</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.readAlarmSensitiveContent"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.readAlarmSensitiveContent">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">readAlarmSensitiveContent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether or not the content color changes when alarm severity</span>
<span class="sd">        changes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True means that the content color will be changed in case of</span>
<span class="sd">            alarm severity changes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alarm_sensitive_content</span></div>

<div class="viewcode-block" id="PyDMWidget.setAlarmSensitiveContent"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.setAlarmSensitiveContent">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">setAlarmSensitiveContent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether or not the content color changes when alarm severity</span>
<span class="sd">        changes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        checked : bool</span>
<span class="sd">            True means that the content color will be changed in case of</span>
<span class="sd">            alarm severity changes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alarm_sensitive_content</span> <span class="o">=</span> <span class="n">checked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alarm_severity_changed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_alarm_state</span><span class="p">)</span></div>

    <span class="n">alarmSensitiveContent</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">readAlarmSensitiveContent</span><span class="p">,</span> <span class="n">setAlarmSensitiveContent</span><span class="p">)</span>

<div class="viewcode-block" id="PyDMWidget.readAlarmSensitiveBorder"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.readAlarmSensitiveBorder">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">readAlarmSensitiveBorder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether or not the border color changes when alarm severity changes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True means that the border color will be changed in case of</span>
<span class="sd">            alarm severity changes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alarm_sensitive_border</span></div>

<div class="viewcode-block" id="PyDMWidget.setAlarmSensitiveBorder"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.setAlarmSensitiveBorder">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">setAlarmSensitiveBorder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether or not the border color changes when alarm severity</span>
<span class="sd">        changes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        checked : bool</span>
<span class="sd">            True means that the border color will be changed in case of</span>
<span class="sd">            alarm severity changes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_alarm_sensitive_border</span> <span class="o">=</span> <span class="n">checked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alarm_severity_changed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_alarm_state</span><span class="p">)</span></div>

    <span class="n">alarmSensitiveBorder</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">readAlarmSensitiveBorder</span><span class="p">,</span> <span class="n">setAlarmSensitiveBorder</span><span class="p">)</span>

<div class="viewcode-block" id="PyDMWidget.readPyDMToolTip"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.readPyDMToolTip">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">readPyDMToolTip</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The tooltip for this widget.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            toolTip : str</span>
<span class="sd">                tooltip info</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pydm_tool_tip</span></div>

<div class="viewcode-block" id="PyDMWidget.setPyDMToolTip"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.setPyDMToolTip">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">setPyDMToolTip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_tip</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The tooltip for this widget.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_tip : str</span>
<span class="sd">            tooltip info</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">new_tip</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pydm_tool_tip</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pydm_tool_tip</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_tip</span><span class="p">)</span>
            <span class="n">parsed_tool_tip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parseTip</span><span class="p">(</span><span class="n">new_tip</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">parsed_tool_tip</span><span class="p">)</span></div>

    <span class="n">PyDMToolTip</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">readPyDMToolTip</span><span class="p">,</span> <span class="n">setPyDMToolTip</span><span class="p">)</span>

<div class="viewcode-block" id="PyDMWidget.parseTip"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.parseTip">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">parseTip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_tip</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fetch the object attribute data for the tooltip.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_tip : str</span>
<span class="sd">            given tooltip string</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        tip_with_attribute_info : str</span>
<span class="sd">            ToolTip string which has had the attribute names replaced with the attribute values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">is_qt_designer</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">new_tip</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tool_tip_substrings</span><span class="p">:</span>
            <span class="n">list_of_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="n">substring</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="k">for</span> <span class="n">substring</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\$\(&quot;</span><span class="p">,</span> <span class="n">new_tip</span><span class="p">)]</span>
            <span class="n">tool_tip_substrings</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">list_of_attributes</span><span class="p">:</span>
                <span class="n">tool_tip_substrings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">new_tip</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">2</span> <span class="p">:</span> <span class="n">new_tip</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">)],</span> <span class="n">new_tip</span><span class="p">[</span><span class="n">index</span> <span class="p">:</span> <span class="n">new_tip</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_tool_tip_substrings</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tool_tip_substrings</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tool_tip_substrings</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tool_tip_substrings</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">tool_tip_substrings</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tool_tip_substrings</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span>
                    <span class="n">value_of_attribute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channel</span>
                <span class="k">elif</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;pv_value&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">value_of_attribute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">attribute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tool_tip_channel_table</span><span class="p">[</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]]</span>
                        <span class="n">value_of_attribute</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">attribute</span> <span class="o">==</span> <span class="s2">&quot;timestamp&quot;</span> <span class="ow">and</span> <span class="n">value_of_attribute</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">value_of_attribute</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">value_of_attribute</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value_of_attribute</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;timestamp&quot;</span> <span class="ow">and</span> <span class="n">value_of_attribute</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">value_of_attribute</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">value_of_attribute</span><span class="p">)</span>

                <span class="n">tool_tip_substrings</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value_of_attribute</span><span class="p">)</span>

        <span class="n">tip_with_attribute_info</span> <span class="o">=</span> <span class="n">new_tip</span>

        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">tool_tip_substrings</span><span class="p">:</span>
            <span class="n">tip_with_attribute_info</span> <span class="o">=</span> <span class="n">tip_with_attribute_info</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">tip_with_attribute_info</span></div>

<div class="viewcode-block" id="PyDMWidget.readChannel"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.readChannel">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">readChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The channel address in use for this widget.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        channel : str</span>
<span class="sd">            Channel address</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PyDMWidget.setChannel"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.setChannel">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">setChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The channel address to use for this widget.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : str</span>
<span class="sd">            Channel address</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_channel</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

    <span class="n">channel</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">readChannel</span><span class="p">,</span> <span class="n">setChannel</span><span class="p">)</span>

<div class="viewcode-block" id="PyDMWidget.set_channel"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.set_channel">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A setter method without a pyqt decorator so subclasses can use this functionality&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
            <span class="c1"># Remove old connections</span>
            <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channels</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">address</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="p">]:</span>
                <span class="n">channel</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_channels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
            <span class="c1"># Load new channel</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Channel was set to an empty string.&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="n">PyDMChannel</span><span class="p">(</span>
                <span class="n">address</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="p">,</span>
                <span class="n">connection_slot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">connectionStateChanged</span><span class="p">,</span>
                <span class="n">value_slot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">channelValueChanged</span><span class="p">,</span>
                <span class="n">severity_slot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alarmSeverityChanged</span><span class="p">,</span>
                <span class="n">enum_strings_slot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">enumStringsChanged</span><span class="p">,</span>
                <span class="n">unit_slot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">prec_slot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">upper_ctrl_limit_slot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">upperCtrlLimitChanged</span><span class="p">,</span>
                <span class="n">lower_ctrl_limit_slot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lowerCtrlLimitChanged</span><span class="p">,</span>
                <span class="n">upper_alarm_limit_slot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_alarm_limit_changed</span><span class="p">,</span>
                <span class="n">lower_alarm_limit_slot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_alarm_limit_changed</span><span class="p">,</span>
                <span class="n">upper_warning_limit_slot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_warning_limit_changed</span><span class="p">,</span>
                <span class="n">lower_warning_limit_slot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_warning_limit_changed</span><span class="p">,</span>
                <span class="n">value_signal</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">write_access_slot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">timestamp_slot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp_changed</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># Load writeable channels if our widget requires them. These should</span>
            <span class="c1"># not exist on the base PyDMWidget but prevents us from duplicating</span>
            <span class="c1"># the method below to only make two more connections</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;writeAccessChanged&quot;</span><span class="p">):</span>
                <span class="n">channel</span><span class="o">.</span><span class="n">write_access_slot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">writeAccessChanged</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;send_value_signal&quot;</span><span class="p">):</span>
                <span class="n">channel</span><span class="o">.</span><span class="n">value_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_value_signal</span>
            <span class="c1"># Do the same thing for classes that use the TextFormatter mixin.</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;unitChanged&quot;</span><span class="p">):</span>
                <span class="n">channel</span><span class="o">.</span><span class="n">unit_slot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitChanged</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;precisionChanged&quot;</span><span class="p">):</span>
                <span class="n">channel</span><span class="o">.</span><span class="n">prec_slot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precisionChanged</span>
            <span class="c1"># Connect write channels if we have them</span>
            <span class="n">channel</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_channels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span></div>

    <span class="k">def</span><span class="w"> </span><span class="nf">restore_original_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tooltip</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tooltip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolTip</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tooltip</span>

<div class="viewcode-block" id="PyDMWidget.check_enable_state"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.check_enable_state">[docs]</a>    <span class="nd">@only_if_channel_set</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_enable_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether or not the widget should be disable.</span>
<span class="sd">        This method also disables the widget and add a Tool Tip</span>
<span class="sd">        with the reason why it is disabled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span>
        <span class="n">tooltip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">restore_original_tooltip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tooltip</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">tooltip</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">tooltip</span> <span class="o">+=</span> <span class="s2">&quot;PV is disconnected.&quot;</span>
            <span class="n">tooltip</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">tooltip</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_address</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">status</span><span class="p">)</span></div>

<div class="viewcode-block" id="PyDMWidget.get_ctrl_limits"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.get_ctrl_limits">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_ctrl_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a tuple with the control limits for the channel</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        (lower, upper) : tuple</span>
<span class="sd">            Lower and Upper control limits</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lower_ctrl_limit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_upper_ctrl_limit</span></div>

<div class="viewcode-block" id="PyDMWidget.channels"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.channels">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">channels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the channels being used for this Widget.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        channels : list</span>
<span class="sd">            List of PyDMChannel objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_channels</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channels</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PyDMWidget.channels_for_tools"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.channels_for_tools">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">channels_for_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of channels useful for external tools.</span>
<span class="sd">        The default implementation here is just to return</span>
<span class="sd">        self.channels(), but some widgets will want to re-implement</span>
<span class="sd">        this, especially if they have multiple channels, but only</span>
<span class="sd">        one real &#39;signal&#39; channel.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">()</span></div>

<div class="viewcode-block" id="PyDMWidget.eventFilter"><a class="viewcode-back" href="../../../widgets/PyDMWidget.html#pydm.widgets.base.PyDMWidget.eventFilter">[docs]</a>    <span class="k">def</span><span class="w"> </span><span class="nf">eventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filters events on this object.</span>

<span class="sd">        Params</span>
<span class="sd">        ------</span>
<span class="sd">        object : QObject</span>
<span class="sd">            The object that is being handled.</span>
<span class="sd">        event : QEvent</span>
<span class="sd">            The event that is happening.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True to stop the event from being handled further; otherwise</span>
<span class="sd">            return false.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">==</span> <span class="n">QEvent</span><span class="o">.</span><span class="n">Enter</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pydm_tool_tip</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parseTip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolTip</span><span class="p">()))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parseTip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pydm_tool_tip</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">eventFilter</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span></div></div>


<span class="k">class</span><span class="w"> </span><span class="nc">PyDMWritableWidget</span><span class="p">(</span><span class="n">PyDMWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PyDM base class for Writable widgets.</span>
<span class="sd">    This class implements the send_value_signal and also the event filter for write access changes on PVs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    init_channel : str, optional</span>
<span class="sd">        The channel to be used by the widget.</span>

<span class="sd">    Signals</span>
<span class="sd">    -------</span>
<span class="sd">    send_value_signal : int, float, str, bool or np.ndarray</span>
<span class="sd">        Emitted when the user changes the value</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__Signals__</span> <span class="o">=</span> <span class="s2">&quot;send_value_signal((int, ), (float, ), (str, ), (bool, ), (object, ))&quot;</span>

    <span class="c1"># Emitted when the user changes the value.</span>
    <span class="n">send_value_signal</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">((</span><span class="nb">int</span><span class="p">,),</span> <span class="p">(</span><span class="nb">float</span><span class="p">,),</span> <span class="p">(</span><span class="nb">str</span><span class="p">,),</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,),</span> <span class="p">(</span><span class="nb">object</span><span class="p">,))</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_channel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_access</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disp_channel</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disable_put</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_monitor_disp</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">init_channel</span><span class="o">=</span><span class="n">init_channel</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">init_for_designer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method called after the constructor to tweak configurations for</span>
<span class="sd">        when using the widget with the Qt Designer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">init_for_designer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_access</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">eventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filters events on this object.</span>

<span class="sd">        Params</span>
<span class="sd">        ------</span>
<span class="sd">        object : QObject</span>
<span class="sd">            The object that is being handled.</span>
<span class="sd">        event : QEvent</span>
<span class="sd">            The event that is happening.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True to stop the event from being handled further; otherwise</span>
<span class="sd">            return false.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">channel</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;channel&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_channel_valid</span><span class="p">(</span><span class="n">channel</span><span class="p">):</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_access</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span>

            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">==</span> <span class="n">QEvent</span><span class="o">.</span><span class="n">Leave</span><span class="p">:</span>
                <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">==</span> <span class="n">QEvent</span><span class="o">.</span><span class="n">Enter</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">status</span><span class="p">:</span>
                <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">QCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ForbiddenCursor</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">PyDMWidget</span><span class="o">.</span><span class="n">eventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">readMonitorDisp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether to monitor the DISP field for this widget&#39;s channel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_monitor_disp</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setMonitorDisp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monitor_disp</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether to monitor the DISP field for this widget&#39;s channel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_monitor_disp</span> <span class="o">!=</span> <span class="n">monitor_disp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_monitor_disp</span> <span class="o">=</span> <span class="n">monitor_disp</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disp_channel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">monitor_disp</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_disp_channel</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_disp_channel</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

    <span class="n">monitorDisp</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">readMonitorDisp</span><span class="p">,</span> <span class="n">setMonitorDisp</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">readChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The channel address in use for this widget.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        channel : str</span>
<span class="sd">            Channel address</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The channel address in use for this widget. Also sets up a monitor on the DISP field.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_channel</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_monitor_disp</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="n">base_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disp_channel</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disp_channel</span><span class="o">.</span><span class="n">address</span> <span class="o">!=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_channel</span><span class="si">}</span><span class="s2">.DISP&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disp_channel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_disp_channel</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_disp_channel</span> <span class="o">=</span> <span class="n">PyDMChannel</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_channel</span><span class="si">}</span><span class="s2">.DISP&quot;</span><span class="p">,</span> <span class="n">value_slot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">disp_value_changed</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_disp_channel</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

    <span class="n">channel</span> <span class="o">=</span> <span class="n">Property</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">readChannel</span><span class="p">,</span> <span class="n">setChannel</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">disp_value_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_disp_value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Callback function to receive changes to the DISP field of the monitored channel&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_disable_put</span> <span class="o">=</span> <span class="n">new_disp_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_enable_state</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_access_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_write_access</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Callback invoked when the Channel has new write access value.</span>
<span class="sd">        This callback calls check_enable_state so it can act on the widget</span>
<span class="sd">        enabling or disabling it accordingly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        new_write_access : bool</span>
<span class="sd">            True if write operations to the channel are allowed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_access</span> <span class="o">=</span> <span class="n">new_write_access</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_enable_state</span><span class="p">()</span>

    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">writeAccessChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">write_access</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        PyQT Slot for changes on the write access value of the Channel</span>
<span class="sd">        This slot sends the write access value to the ```write_access_changed``` callback.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        write_access : bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_access_changed</span><span class="p">(</span><span class="n">write_access</span><span class="p">)</span>

    <span class="nd">@only_if_channel_set</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_enable_state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether or not the widget should be disabled.</span>
<span class="sd">        This method also disables the widget and adds a tool tip with the reason why it is disabled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_access</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disable_put</span>
        <span class="n">tooltip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">restore_original_tooltip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connected</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tooltip</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">tooltip</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">tooltip</span> <span class="o">+=</span> <span class="s2">&quot;PV is disconnected.&quot;</span>
            <span class="n">tooltip</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">tooltip</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_address</span><span class="p">()</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_access</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tooltip</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">tooltip</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">data_plugins</span><span class="o">.</span><span class="n">is_read_only</span><span class="p">():</span>
                <span class="n">tooltip</span> <span class="o">+=</span> <span class="s2">&quot;Running PyDM on Read-Only mode.&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tooltip</span> <span class="o">+=</span> <span class="s2">&quot;Access denied by Channel Access Security.&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disable_put</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tooltip</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">tooltip</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">tooltip</span> <span class="o">+=</span> <span class="s2">&quot;Access denied by DISP field&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">tooltip</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, hhslepicka, trendahl, zlentz, yektay, nstelter.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>